<!doctype html><html lang=en><head><title>Κάντε Auto-mount συσκευές κατά την εκκίνηση του συστήματος χωρίς αλλαγές στο /etc/fstab :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Σημαντική Ανακοίνωση: Το παρών άρθρο έχει δημοσιτευτεί επίσημα στο Linux-User.gr και διατηρείται εδώ για καθαρά λόγους αρχειοθέτησης.
Η Ιστορία: Ένα από τα προβλήματα που εντόπισα όταν αποφάσισα να προσθέσω εξωτερικό δίσκο στο Raspberry Pi 4 server μου, ήταν ότι για να πραγματοποιηθεί αυτόματα το mount κατά το boot, έπρεπε να κάνω κάποιες αλλαγές στο /etc/fstab . To πρόβλημα που υπήρχε με αυτή την λύση ήταν η Ρώσικη ρουλέτα.
Το πρόβλημα: Οποιοδήποτε συντακτικό/λογικό λάθος πάνω στην αλλαγή, κατέληγες σε grub rescue που έπρεπε να μπει ποντίκι-πληκτρολόγιο για να πραγματοποιηθούν αλλαγές, είτε να αφαιρεθεί η sd από το Raspberry Pi, να συνδεθεί σε άλλο σύστημα και να αναιρεθεί η αλλαγή."><meta name=keywords content="decentralized"><meta name=robots content="noodp"><link rel=canonical href=/greek_articles/fstab/><link rel=stylesheet href=/styles.css><link rel="shortcut icon" href=/favicon.ico><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Κάντε Auto-mount συσκευές κατά την εκκίνηση του συστήματος χωρίς αλλαγές στο /etc/fstab"><meta property="og:description" content="Σημαντική Ανακοίνωση: Το παρών άρθρο έχει δημοσιτευτεί επίσημα στο Linux-User.gr και διατηρείται εδώ για καθαρά λόγους αρχειοθέτησης.
Η Ιστορία: Ένα από τα προβλήματα που εντόπισα όταν αποφάσισα να προσθέσω εξωτερικό δίσκο στο Raspberry Pi 4 server μου, ήταν ότι για να πραγματοποιηθεί αυτόματα το mount κατά το boot, έπρεπε να κάνω κάποιες αλλαγές στο /etc/fstab . To πρόβλημα που υπήρχε με αυτή την λύση ήταν η Ρώσικη ρουλέτα.
Το πρόβλημα: Οποιοδήποτε συντακτικό/λογικό λάθος πάνω στην αλλαγή, κατέληγες σε grub rescue που έπρεπε να μπει ποντίκι-πληκτρολόγιο για να πραγματοποιηθούν αλλαγές, είτε να αφαιρεθεί η sd από το Raspberry Pi, να συνδεθεί σε άλλο σύστημα και να αναιρεθεί η αλλαγή."><meta property="og:url" content="/greek_articles/fstab/"><meta property="og:site_name" content><meta property="og:image" content="/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2022-10-10 00:00:00 +0000 UTC"></head><body class=lime><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Dimitris Vagiakakos SV1SJP</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/whoami>$whoami</a></li><li><a href=/about>About TuxHouse</a></li><li><a href=/blockchain_camera>Blockchain Camera</a></li><li><a href=/blockchain_writeups>Blockchain WriteUps</a></li><li><a href=/greek_articles>Greek Articles</a></li><li><a href=https://fosstodon.org/@sv1sjp>micro-blogging</a></li><li><a href=/panellinies_aepp/index.html>Panellinies_AEPP</a></li><li><a href=/projects>Projects</a></li><li><a href=/ubuntel>Ubuntel</a></li><li><a href=https://odysee.com/@TuxHouse:1>Videos</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/whoami>$whoami</a></li><li><a href=/about>About TuxHouse</a></li><li><a href=/blockchain_camera>Blockchain Camera</a></li><li><a href=/blockchain_writeups>Blockchain WriteUps</a></li><li><a href=/greek_articles>Greek Articles</a></li><li><a href=https://fosstodon.org/@sv1sjp>micro-blogging</a></li><li><a href=/panellinies_aepp/index.html>Panellinies_AEPP</a></li><li><a href=/projects>Projects</a></li><li><a href=/ubuntel>Ubuntel</a></li><li><a href=https://odysee.com/@TuxHouse:1>Videos</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=/greek_articles/fstab/>Κάντε Auto-mount συσκευές κατά την εκκίνηση του συστήματος χωρίς αλλαγές στο /etc/fstab</a></h1><div class=post-meta><time class=post-date>2022-10-10</time><span class=post-author>Dimitris Vagiakakos</span><span class=post-reading-time>3 min read (521 words)</span></div><div class=post-content><div><p><a href=https://linux-user.gr/t/kante-auto-mount-syskeyes-kata-thn-ekkinhsh-toy-systhmatos-chwris-allages-sto-etc-fstab/4602>Σημαντική Ανακοίνωση: Το παρών άρθρο έχει δημοσιτευτεί επίσημα στο Linux-User.gr και διατηρείται εδώ για καθαρά λόγους αρχειοθέτησης.</a></p><h2 id=η-ιστορία>Η Ιστορία:<a href=#η-ιστορία class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Ένα από τα προβλήματα που εντόπισα όταν αποφάσισα να προσθέσω εξωτερικό δίσκο στο Raspberry Pi 4 server μου, ήταν ότι για να πραγματοποιηθεί αυτόματα το mount κατά το boot, έπρεπε να κάνω κάποιες αλλαγές στο <a href=https://linux-user.gr/t/auto-mount-devices-kata-thn-ekkinhsh-toy-systhmatos-video-guide/3193>/etc/fstab</a> . To πρόβλημα που υπήρχε με αυτή την λύση ήταν η Ρώσικη ρουλέτα.</p><h3 id=το-πρόβλημα>Το πρόβλημα:<a href=#το-πρόβλημα class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Οποιοδήποτε συντακτικό/λογικό λάθος πάνω στην αλλαγή, κατέληγες σε grub rescue που έπρεπε να μπει ποντίκι-πληκτρολόγιο για να πραγματοποιηθούν αλλαγές, είτε να αφαιρεθεί η sd από το Raspberry Pi, να συνδεθεί σε άλλο σύστημα και να αναιρεθεί η αλλαγή.
Επιπλέον, υπήρχε και το πρόβλημα του αν για οποιοδήποτε λόγο δεν ήταν συνδεδεμένη η συσκευή κατά το boot, πάλι κατέληγε σε grub rescue.. Και αν εκείνη την ώρα απουσίαζες από το σπίτι και έκανες αλλαγές μέσω ssh και VPN.. και κάποιος από λάθος αφαίρεσε/κούνησε το καλώδιο&mldr;.. RIP</p><p>Συνεπώς, έπρεπε να βρω μία διαφορετική προσέγγιση για να επιλύσω το πρόβλημα μου με το automount. Εκεί έρχεται η λύση που προσφέρει το Auto-Fs.</p><h3 id=η-λύση-στο-πρόβλημα>Η λύση στο πρόβλημα:<a href=#η-λύση-στο-πρόβλημα class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Το autofs πρόκειται για ένα πρόγραμμα για την αυτόματη προσάρτηση συσκευών ανάλογα με τις ανάγκες του χρήστη σε πραγματικό χρόνο. Οι αυτόματες προσαρτήσεις γίνονται mount μόνο κατά την προσπέλαση και un-mount μετά από μια περίοδο αδράνειας. Εξαιτίας αυτού, η αυτόματη προσάρτηση κοινών αρχείων NFS/Samba εξοικονομεί bandwith και τελικά προσφέρει καλύτερες συνολικές επιδόσεις σε σύγκριση με τις στατικές προσαρτήσεις μέσω της fstab.</p><p>Παραδοσιακά για εγκατάσταση του autofs σε Debian based συστήματα δίνουμε:</p><pre tabindex=0><code>sudo apt install autofs
</code></pre><p>Για τα Fed-ωραία και τα υπόλοιπα distros ( i use arch btw), μπορείτε να δώσετε τις αντίστοιχες εντολές εγκατάστασης βάση του package manager && repository που χρησιμοποιεί η δικιά σας διανομή Linux. DuckDuckGo it λοιπόν!</p><h2 id=ρύθμιση-του-autofs>Ρύθμιση του autofs<a href=#ρύθμιση-του-autofs class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Για να λειτουργήσει ομαλά το mount με το AutoFs, πρέπει να κάνουμε αλλαγές σε 2 αρχεία:</p><ul><li>Στο auto.master έτσι ώστε να το οδηγήσουμε στο directory που θέλουμε να κάνει αυτόματα mount,</li><li>Στο auto.usb οπού θα εξηγεί στο autofs τα τι που πώς, σχετικά με την συσκευή που θέλουμε να κάνουμε mount.</li></ul><h3 id=επεξεργασία-automaster>Επεξεργασία auto.master<a href=#επεξεργασία-automaster class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Ανοίγουμε έναν test editor για να το επεξεργαστούμε (εγώ δουλεύω με nano):</p><pre tabindex=0><code>sudo nano /etc/auto.master
</code></pre><p>και έπειτα προσθέτουμε το εξής:</p><pre tabindex=0><code>/media    /etc/auto.usb    --timeout=60 --ghost
</code></pre><p>Kαι τώρα μπορούμε να δημιουργήσουμε το auto.usb αρχείο. Συνεχίζουμε από τερματικό:</p><pre tabindex=0><code>sudo nano /etc/auto.usb
</code></pre><p>Και προσθέτουμε την παρακάτω γραμμή:</p><pre tabindex=0><code>myUSB -fstype=auto,uid=pi,gid=pi,rw UUID=YOUR_UUID
</code></pre><p>Οπού:</p><ul><li>myUSB : Το όνομα του φακέλου που θα εμφανιστεί εντός /media. Στο παράδειγμα π.χ. θα εμφανιστεί ως <code>/media/myUSB</code>,</li><li>Το -fstype ορίζουμε τον τύπο του filesystem οπού είναι η συσκευή οπού θα κάνουμε mount.</li><li>uid του χρήστη μας,</li><li>gid της ομάδας που συμμετέχει ο χρήστης μας,</li><li>rw οπού δίνουμε read write δικαιώματα,</li><li>το UUID της συσκευής.</li></ul><p>Για να βρούμε το UUID της συσκευής μας, δίνουμε:</p><pre tabindex=0><code>sudo lsblk -f | grep -v loop
</code></pre><p>Φυσικά αποθηκεύουμε τις αλλαγές και έπειτα κάνουμε και μία επανεκκίνηση στο systemd service:</p><pre tabindex=0><code>sudo systemctl restart autofs.service
</code></pre><p>Και είμαστε έτοιμοι!!!</p><h3 id=unmount>Unmount<a href=#unmount class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Φυσικά, αν για οποιοδήποτε λόγο θέλουμε να αφαιρέσουμε την συσκευή ενώ έχουμε τo PC/RaspberryPi/Server ανοικτό, απλά δίνουμε:</p><pre tabindex=0><code>sudo umount /media/myUSB
</code></pre><p>Και όταν τον συνδέσουμε ξανά, το autofs θα τον ξανακάνει mount αυτόματα. :)</p></div></div></article></div><footer class=footer><a rel=me href=https://fosstodon.org/@sv1sjp></a><div class=footer__inner><div class=copyright><span>© Powered by TuxHouse - Dimitris LinuxOS 2011-2024</span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>